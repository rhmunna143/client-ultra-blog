"use strict";(self.webpackChunkclient_ultra_blog=self.webpackChunkclient_ultra_blog||[]).push([[977],{"./src/components/NewPost/NewPostForm.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Black:()=>Black,Dark:()=>Dark,Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>NewPostForm_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),constant=__webpack_require__("./src/app/lib/constant.js"),useImgBbUpload=__webpack_require__("./src/hooks/useImgBbUpload.jsx"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.mjs"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.mjs"),dist=__webpack_require__("./node_modules/react-hot-toast/dist/index.mjs"),console=__webpack_require__("./node_modules/console-browserify/index.js");const NewPostForm=()=>{const{uploadImage,loading,error,imageUrl}=(0,useImgBbUpload.A)(constant.R),[selectedFile,setSelectedFile]=(0,react.useState)(null),{register,handleSubmit,watch,setValue,formState:{errors}}=(0,index_esm.mN)();return(0,jsx_runtime.jsxs)("div",{className:"my-20",children:[(0,jsx_runtime.jsxs)("div",{className:"border max-w-60 mx-auto",children:[!imageUrl&&(0,jsx_runtime.jsx)("p",{className:"text-center pt-10",children:"No image uploaded"}),imageUrl&&(0,jsx_runtime.jsx)(next_image.A,{src:imageUrl,alt:"uploaded",className:"mt-2",width:240,height:112,layout:"responsive"})]}),(0,jsx_runtime.jsxs)("form",{onSubmit:handleSubmit((data=>{const payload={title:data.title,content:data.content,image_link:imageUrl};axios.A.post("".concat(constant.p,"/posts"),payload,{withCredentials:!0}).then((res=>{var _res_data;(null===(_res_data=res.data)||void 0===_res_data?void 0:_res_data.id)&&(dist.Ay.success("Post created successfully"),setValue("title",""),setValue("content",""),setSelectedFile(null))})).catch((err=>{dist.Ay.error("Failed to create post"),console.error(err)}))})),className:"max-w-3xl mx-auto",children:[(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Image"})}),(0,jsx_runtime.jsx)("input",{...register("image",{required:"Image is required"}),type:"file",onChange:e=>{(e=>{const file=e.target.files[0];setSelectedFile(file)})(e),register("image").onChange(e)},className:"input input-bordered pt-2"}),errors.image&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.image.message}),(0,jsx_runtime.jsxs)("div",{className:"upload",children:[(0,jsx_runtime.jsx)("button",{onClick:()=>{selectedFile&&uploadImage(selectedFile)},disabled:loading||!selectedFile,type:"button",className:"btn btn-outline btn-sm mt-2 float-right",children:"Upload"}),loading&&(0,jsx_runtime.jsx)("span",{className:"text-blue-500",children:"Uploading..."})]})]}),(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Title"})}),(0,jsx_runtime.jsx)("input",{...register("title",{required:"Title is required"}),type:"text",placeholder:"title",className:"input input-bordered"}),errors.title&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.title.message})]}),(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Content"})}),(0,jsx_runtime.jsx)("textarea",{...register("content",{required:"Content is required"}),placeholder:"content",className:"textarea textarea-bordered"}),errors.content&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.content.message})]}),(0,jsx_runtime.jsx)("div",{className:"form-control mt-6 w-1/2 mx-auto",children:(0,jsx_runtime.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Post Now"})})]})]})},NewPost_NewPostForm=NewPostForm;var _Default_parameters,_Default_parameters_docs,_Default_parameters1,_Dark_parameters,_Dark_parameters_docs,_Dark_parameters1,_Black_parameters,_Black_parameters_docs,_Black_parameters1;NewPostForm.__docgenInfo={description:"",methods:[],displayName:"NewPostForm"};const NewPostForm_stories={title:"Posts/NewPostForm",component:NewPost_NewPostForm,argTypes:{onSubmit:{action:"submitted"}},tags:["autodocs"]},Default=()=>(0,jsx_runtime.jsx)(NewPost_NewPostForm,{}),Dark=()=>(0,jsx_runtime.jsx)(NewPost_NewPostForm,{}),Black=()=>(0,jsx_runtime.jsx)(NewPost_NewPostForm,{});Default.parameters={...Default.parameters,docs:{...null===(_Default_parameters=Default.parameters)||void 0===_Default_parameters?void 0:_Default_parameters.docs,source:{originalSource:"() => <NewPostForm />",...null===(_Default_parameters1=Default.parameters)||void 0===_Default_parameters1||null===(_Default_parameters_docs=_Default_parameters1.docs)||void 0===_Default_parameters_docs?void 0:_Default_parameters_docs.source}}},Dark.parameters={...Dark.parameters,docs:{...null===(_Dark_parameters=Dark.parameters)||void 0===_Dark_parameters?void 0:_Dark_parameters.docs,source:{originalSource:"() => <NewPostForm />",...null===(_Dark_parameters1=Dark.parameters)||void 0===_Dark_parameters1||null===(_Dark_parameters_docs=_Dark_parameters1.docs)||void 0===_Dark_parameters_docs?void 0:_Dark_parameters_docs.source}}},Black.parameters={...Black.parameters,docs:{...null===(_Black_parameters=Black.parameters)||void 0===_Black_parameters?void 0:_Black_parameters.docs,source:{originalSource:"() => <NewPostForm />",...null===(_Black_parameters1=Black.parameters)||void 0===_Black_parameters1||null===(_Black_parameters_docs=_Black_parameters1.docs)||void 0===_Black_parameters_docs?void 0:_Black_parameters_docs.source}}};const __namedExportsOrder=["Default","Dark","Black"]},"./src/app/lib/constant.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>imgBBApiKey,p:()=>baseUrl});const baseUrl="https://server-ultra-blog.vercel.app/api",imgBBApiKey="8dde3e3ff1f547a16312413a213e875a"},"./src/hooks/useImgBbUpload.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/lib/axios.js");const __WEBPACK_DEFAULT_EXPORT__=apiKey=>{const[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[imageUrl,setImageUrl]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);return{uploadImage:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((async imageFile=>{setLoading(!0),setError(null),setImageUrl(null);const formData=new FormData;formData.append("image",imageFile);try{const response=await axios__WEBPACK_IMPORTED_MODULE_1__.A.post("https://api.imgbb.com/1/upload?key=".concat(apiKey),formData);if(!(response.data&&response.data.data&&response.data.data.url))throw new Error("Image upload failed");setImageUrl(response.data.data.url)}catch(err){setError(err.message)}finally{setLoading(!1)}}),[apiKey]),loading,error,imageUrl}}}}]);