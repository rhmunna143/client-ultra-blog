"use strict";(self.webpackChunkclient_ultra_blog=self.webpackChunkclient_ultra_blog||[]).push([[119],{"./src/components/UpdatePost/UpdatePost.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,WithAuthor:()=>WithAuthor,WithContent:()=>WithContent,WithTags:()=>WithTags,WithTitle:()=>WithTitle,__namedExportsOrder:()=>__namedExportsOrder,default:()=>UpdatePost_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),constant=__webpack_require__("./src/app/lib/constant.js"),useImgBbUpload=__webpack_require__("./src/hooks/useImgBbUpload.jsx"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");const hooks_usePostById=id=>{const[post,setPost]=(0,react.useState)({});return(0,react.useEffect)((()=>{axios.A.get("".concat(constant.p,"/posts/").concat(id)).then((res=>{var _res_data;(null===(_res_data=res.data)||void 0===_res_data?void 0:_res_data.id)&&setPost(res.data)})).catch((err=>{console.error(err)}))}),[id]),post};var next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.mjs"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.mjs"),dist=__webpack_require__("./node_modules/react-hot-toast/dist/index.mjs"),UpdatePost_console=__webpack_require__("./node_modules/console-browserify/index.js");const UpdatePostForm=()=>{const{uploadImage,loading,error,imageUrl}=(0,useImgBbUpload.A)(constant.R),[selectedFile,setSelectedFile]=(0,react.useState)(null),{id}=(0,navigation.useParams)(),{title,image_link,content}=hooks_usePostById(id),{register,handleSubmit,watch,setValue,formState:{errors}}=(0,index_esm.mN)();return(0,jsx_runtime.jsxs)("div",{className:"my-20",children:[(0,jsx_runtime.jsxs)("div",{className:"border max-w-60 mx-auto mb-4",children:[!imageUrl&&!image_link&&(0,jsx_runtime.jsx)("p",{className:"text-center pt-10",children:"No image uploaded"}),imageUrl&&(0,jsx_runtime.jsx)(next_image.A,{src:imageUrl,alt:"uploaded",className:"mt-2 object-cover",width:240,height:112,layout:"responsive"}),!imageUrl&&image_link&&(0,jsx_runtime.jsx)(next_image.A,{src:image_link,alt:"uploaded",className:"mt-2 object-cover",width:240,height:112,layout:"responsive"})]}),(0,jsx_runtime.jsxs)("form",{onSubmit:handleSubmit((data=>{const payload={title:data.title?data.title:title,content:data.content?data.content:content,image_link:imageUrl||image_link};axios.A.put("".concat(constant.p,"/posts/").concat(id),payload,{withCredentials:!0}).then((res=>{var _res_data;(null===(_res_data=res.data)||void 0===_res_data?void 0:_res_data.id)&&dist.Ay.success("Post updated successfully")})).catch((err=>{dist.Ay.error("Failed to update post"),UpdatePost_console.error(err)}))})),className:"max-w-3xl mx-auto",children:[(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Image"})}),(0,jsx_runtime.jsx)("input",{...register("image"),type:"file",onChange:e=>{(e=>{const file=e.target.files[0];setSelectedFile(file)})(e),register("image").onChange(e)},className:"input input-bordered pt-2"}),errors.image&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.image.message}),(0,jsx_runtime.jsxs)("div",{className:"upload",children:[(0,jsx_runtime.jsx)("button",{onClick:()=>{selectedFile&&uploadImage(selectedFile)},disabled:loading||!selectedFile,type:"button",className:"btn btn-outline btn-sm mt-2 float-right",children:"Upload"}),loading&&(0,jsx_runtime.jsx)("span",{className:"text-blue-500",children:"Uploading..."}),error&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:error})]})]}),(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Title"})}),(0,jsx_runtime.jsx)("input",{...register("title"),type:"text",defaultValue:title,placeholder:"title",className:"input input-bordered"}),errors.title&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.title.message})]}),(0,jsx_runtime.jsxs)("div",{className:"form-control",children:[(0,jsx_runtime.jsx)("label",{className:"label",children:(0,jsx_runtime.jsx)("span",{className:"label-text",children:"Content"})}),(0,jsx_runtime.jsx)("textarea",{...register("content"),defaultValue:content,placeholder:"content",className:"textarea textarea-bordered"}),errors.content&&(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:errors.content.message})]}),(0,jsx_runtime.jsx)("div",{className:"form-control mt-6 w-1/2 mx-auto",children:(0,jsx_runtime.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update Post Now"})})]})]})},UpdatePost=UpdatePostForm;var _Default_parameters,_Default_parameters_docs,_Default_parameters1,_WithTitle_parameters,_WithTitle_parameters_docs,_WithTitle_parameters1,_WithContent_parameters,_WithContent_parameters_docs,_WithContent_parameters1,_WithAuthor_parameters,_WithAuthor_parameters_docs,_WithAuthor_parameters1,_WithTags_parameters,_WithTags_parameters_docs,_WithTags_parameters1;UpdatePostForm.__docgenInfo={description:"",methods:[],displayName:"UpdatePostForm"};const UpdatePost_stories={title:"Posts/UpdatePost",component:UpdatePost,tags:["autodocs"]},Default=()=>(0,jsx_runtime.jsx)(UpdatePost,{}),WithTitle=()=>(0,jsx_runtime.jsx)(UpdatePost,{title:"Sample Title"}),WithContent=()=>(0,jsx_runtime.jsx)(UpdatePost,{content:"Sample Content"}),WithAuthor=()=>(0,jsx_runtime.jsx)(UpdatePost,{author:"John Doe"}),WithTags=()=>(0,jsx_runtime.jsx)(UpdatePost,{tags:["react","javascript"]});Default.parameters={...Default.parameters,docs:{...null===(_Default_parameters=Default.parameters)||void 0===_Default_parameters?void 0:_Default_parameters.docs,source:{originalSource:"() => <UpdatePost />",...null===(_Default_parameters1=Default.parameters)||void 0===_Default_parameters1||null===(_Default_parameters_docs=_Default_parameters1.docs)||void 0===_Default_parameters_docs?void 0:_Default_parameters_docs.source}}},WithTitle.parameters={...WithTitle.parameters,docs:{...null===(_WithTitle_parameters=WithTitle.parameters)||void 0===_WithTitle_parameters?void 0:_WithTitle_parameters.docs,source:{originalSource:'() => <UpdatePost title="Sample Title" />',...null===(_WithTitle_parameters1=WithTitle.parameters)||void 0===_WithTitle_parameters1||null===(_WithTitle_parameters_docs=_WithTitle_parameters1.docs)||void 0===_WithTitle_parameters_docs?void 0:_WithTitle_parameters_docs.source}}},WithContent.parameters={...WithContent.parameters,docs:{...null===(_WithContent_parameters=WithContent.parameters)||void 0===_WithContent_parameters?void 0:_WithContent_parameters.docs,source:{originalSource:'() => <UpdatePost content="Sample Content" />',...null===(_WithContent_parameters1=WithContent.parameters)||void 0===_WithContent_parameters1||null===(_WithContent_parameters_docs=_WithContent_parameters1.docs)||void 0===_WithContent_parameters_docs?void 0:_WithContent_parameters_docs.source}}},WithAuthor.parameters={...WithAuthor.parameters,docs:{...null===(_WithAuthor_parameters=WithAuthor.parameters)||void 0===_WithAuthor_parameters?void 0:_WithAuthor_parameters.docs,source:{originalSource:'() => <UpdatePost author="John Doe" />',...null===(_WithAuthor_parameters1=WithAuthor.parameters)||void 0===_WithAuthor_parameters1||null===(_WithAuthor_parameters_docs=_WithAuthor_parameters1.docs)||void 0===_WithAuthor_parameters_docs?void 0:_WithAuthor_parameters_docs.source}}},WithTags.parameters={...WithTags.parameters,docs:{...null===(_WithTags_parameters=WithTags.parameters)||void 0===_WithTags_parameters?void 0:_WithTags_parameters.docs,source:{originalSource:"() => <UpdatePost tags={['react', 'javascript']} />",...null===(_WithTags_parameters1=WithTags.parameters)||void 0===_WithTags_parameters1||null===(_WithTags_parameters_docs=_WithTags_parameters1.docs)||void 0===_WithTags_parameters_docs?void 0:_WithTags_parameters_docs.source}}};const __namedExportsOrder=["Default","WithTitle","WithContent","WithAuthor","WithTags"]},"./src/app/lib/constant.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>imgBBApiKey,p:()=>baseUrl});const baseUrl="https://server-ultra-blog.vercel.app/api",imgBBApiKey="8dde3e3ff1f547a16312413a213e875a"},"./src/hooks/useImgBbUpload.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/lib/axios.js");const __WEBPACK_DEFAULT_EXPORT__=apiKey=>{const[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[imageUrl,setImageUrl]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);return{uploadImage:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((async imageFile=>{setLoading(!0),setError(null),setImageUrl(null);const formData=new FormData;formData.append("image",imageFile);try{const response=await axios__WEBPACK_IMPORTED_MODULE_1__.A.post("https://api.imgbb.com/1/upload?key=".concat(apiKey),formData);if(!(response.data&&response.data.data&&response.data.data.url))throw new Error("Image upload failed");setImageUrl(response.data.data.url)}catch(err){setError(err.message)}finally{setLoading(!1)}}),[apiKey]),loading,error,imageUrl}}}}]);